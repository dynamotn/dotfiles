#!{{ lookPath "bash" }}
set -Eeou pipefail
source {{ .chezmoi.sourceDir }}/../scripts/message.sh
trap "_error \"Can't setup fish shell\"" ERR

_notice "Setup fish shell"
# plugins hash: {{ joinPath .chezmoi.sourceDir "../silos/fish/fish_plugins" | include | sha256sum }}
if [[ $SHELL != "$(which fish)" ]]; then
  _info "Change default shell to fish"
  chsh -s "$(which fish)"
fi
fish {{ .chezmoi.homeDir }}/.config/fish/setup.fish

_progress "Install neccessary tools"
{{ if eq .kind "pc" -}}
fish -c "install_asdf"
fish -c "install_gcloud"
fish -c "install_kubectl"
fish -c "install_helm"
fish -c "install_terraform"
fish -c "install_pre_commit"
{{ end }}
_success "Setup fish shell"
